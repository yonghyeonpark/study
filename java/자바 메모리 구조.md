# 자바 메모리 구조

<img src="https://github.com/yonghyeonpark/Java-Study/assets/126778700/d473c663-9158-4fe7-8b11-ef63feee09e7" width="700">

## 메서드 영역

- 프로그램 실행에 필요한 공통 데이터를 관리하는 영역으로, 모든 스레드가 공유합니다.
- 클래스 로딩 시 한 번만 할당되며, 프로그램 종료까지 유지됩니다.
- 클래스 메타데이터 저장
  - 클래스 이름, 생성자 정보, 필드 정보, 메서드 정보 등 클래스 관련 데이터를 저장합니다.
- `static` 변수 저장
- 런타임 상수 풀
  - 프로그램 실행 중 공통으로 사용하는 리터럴 상수를 저장합니다.
  - 단, `new String()`을 통해 생성된 문자열은 힙 영역에 저장합니다.

## 스택 영역

- 스레드마다 개별적인 `스택 영역`이 생성됩니다.
- 메서드가 호출될 때마다 `스택 프레임`이 쌓이고, 메서드가 종료되면 해당 프레임이 제거됩니다.
- 각 스택 프레임에는 `지역 변수`, `매개 변수`, `반환 주소` 등을 저장합니다.

## 힙 영역

- `new` 연산자를 통해 생성된 객체와 배열을 저장하는 영역입니다.
- `가비지 컬렉션`이 이루어지는 주요 영역이며, 더 이상 참조되지 않는 객체는 `가비지 컬렉터`에 의해 제거됩니다.
- 객체가 생성될 때, 인스턴스 변수에는 메모리가 할당되지만, 인스턴스 메서드는 별도의 메모리 할당 없이 메서드 영역에서 공통으로 관리됩니다.
  - 인스턴스 메서드는 힙이 아닌 메서드 영역에 저장되며, 실행 시 스택에서 호출됩니다.<br>
  <img src="https://github.com/yonghyeonpark/Java-Study/assets/126778700/56e865aa-4586-4add-9a03-845d0ca430eb" width="600"><br>

## 변수 용어와 생명주기

### 지역 변수(매개변수 포함)

- `스택 영역`의 `스택 프레임` 안에 저장합니다.
- 메서드 내부에서 선언된 변수로, 해당 메서드가 실행될 때 생성되고 종료될 때 제거됩니다.

### 인스턴스 변수

- static 키워드가 붙지 않은 멤버 변수로, 객체를 생성해야 사용할 수 있습니다.
- 객체를 생성할 때마다 새롭게 할당됩니다.
- 힙 영역에 저장하며, GC가 발생하기 전까지는 유지되므로, 보통 지역 변수보다 생존 주기가 깁니다.

### 클래스 변수(static 변수)

- static 키워드가 붙은 멤버 변수로, 힙 영역이 아닌 메서드 영역에 저장합니다.
- 모든 객체가 공유하며, 객체 생성 없이 클래스 이름으로 직접 접근할 수 있습니다. 
- 프로그램 실행 동안 유지됩니다.

## 메서드 용어

### 인스턴스 메서드

- static 키워드가 붙지 않은 멤버 메서드입니다.
- 객체가 생성된 후에만 호출할 수 있습니다.

### 클래스 메서드(static 메서드)

- static 키워드가 붙은 멤버 메서드입니다.
- 클래스 메서드는 객체 없이 호출되므로, 인스턴스 변수나 인스턴스 메서드를 직접 사용할 수 없습니다.
<br>(사용하려면 내부에서 객체를 생성해야 합니다.)
- 보통 유틸리티성 메서드를 만들 때 사용합니다.

## 참고

- [김영한 - 실전 자바 기본편](https://www.inflearn.com/course/%EA%B9%80%EC%98%81%ED%95%9C%EC%9D%98-%EC%8B%A4%EC%A0%84-%EC%9E%90%EB%B0%94-%EA%B8%B0%EB%B3%B8%ED%8E%B8)